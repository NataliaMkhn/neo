Описание проектной работы

ссылка на репозиторий:
https://github.com/NataliaMkhn/neo/tree/master


Даги airflow
------------

de_1_1_create_tables_and_procedures   - проектное задание 1. Создание схем и таблиц в БД, а также всех процедур обработки данных.

de_1_2_spark_insert_data   - проектное задание 1. Чтение данных из файлов csv (расположение файлов: папка files/input1). запись данных в таблицы БД.

de_1_3_fill_month   - проектное задание 1. Расчет витрин и формы 101 за полный месяц. Даг запускается С ПАРАМЕТРОМ! параметр - дата, на которую 
                      нужно заполнить форму 101. Если необходимо заполнить форму за январь 2018, то параметр равен "2018-02-01" (на 1 февраля).
                      Выгрузка витрины в csv файл (расположение файлов: папка files/output1)

from_csv_101_f   - проектное задание 1. Загружает данные формы 101 из созданного ранее csv файла в копию витрины формы 101.


de_2_db_initialized  - проектное задание 2. Даг создания и заполнения таблиц в БД второго проектного задания. Выполняет скрипт, предоставленный
                       в материалах к заданию 2.


de_2_1   - проектное задание 2, задача 2.1. Выявление и удаление дублей в таблице dm.client.

de_2_2   - проектное задание 2, задача 2.2. Анализ заполнения витрины dm.loan_holiday_info, дозагрузка исходных данных из csv (расположение 
           файлов: папка files/input2), перезагрузка данных в витрину, просмотр результата.

de_2_2   - проектное задание 2, задача 2.3. Анализ заполнения витрины dm.account_balance_turnover, расчет корректных входящих (исходящих)
           остатков, исправление данных в таблице rd.account_balance, перезагрузка данных в витрину, вывод результата.



Скрипты sql (папка dags/sql. Все скрипты вызываются из дагов airflow)
-----------

Проектное задание 1:
1_1 create_table   - скрипт создания схем и таблиц в базе данных к первому проектному заданию.
1_1 insert_data (spark)   -  скрипт обработки данных после загрузки (приведение к нужным типам данных, удаление дубликатов) и загрузки в таблицы.
1_2 fill_balance_turnover   - скрипт создания процедуры расчета витрины оборотов и процедуры расчета витрины остатков за определенную дату.
1_2 fill_month   - скрипт расчета всех витрин за один полный месяц. 
1_3 fill_101   - скрипт расчета формы 101 за один месяц.

Проектное задание 2:
DATABASE_DUMP   - скрипт создания схем и таблиц в базе данных ко второму проектному заданию (предоставлен в материалах задания).

2_2_proc_fill_loan_h   - скрипт создания процедуры расчета витрины dm.loan_holiday_info для задачи 2.2.
2_3_proc_fill_bal_turn   - скрипт создания процедуры расчета витрины dm.account_balance_turnover для задачи 2.3.







ссылки на видео в яндекс-диске:
-------------------------------

к проектной работе 2:
https://disk.yandex.ru/i/eQTLC2ks_Rv1AQ - видео к задаче 1.1. (начало)
https://disk.yandex.ru/i/yxG1hIKVd81tpg - видео к задаче 1.1. (продолжение)

https://disk.yandex.ru/i/wn7ltdfqw92yPw - видео к задаче 1.2. (начало)
https://disk.yandex.ru/i/1wZa5jNUqzQULQ - видео к задаче 1.2. (продолжение)

https://disk.yandex.ru/i/XzsBuHXee1R2jg - видео к задаче 1.3. (начало)
https://disk.yandex.ru/i/61PH-vJUvjqrOg - видео к задаче 1.3. (продолжение)




к проектной работе 1:
https://disk.yandex.ru/i/1TbrD3nUrtEAvA  - демонстрация создания таблиц, запуска всего потока, просмотр таблицы логов.

https://disk.yandex.ru/i/6H_zptw8gYQzWg - видео к задаче 1.1. (Продемонстрируйте как вы в файле «ft_balance_f.csv» 
меняете баланс для какого-нибудь <account_rk>, показываете что в таблице «DS.ft_balance_f» сперва была одна сумма 
у этого <account_rk> - потом запускаете ETL-процесс и показываете, что в таблице сумма обновилась)

https://disk.yandex.ru/i/_CjpAUdqGRaJIg - видео к задаче 1.2. (Нужно продемонстрировать, как вы запускаете расчёт 
ежедневной витрины оборотов и витрины остатков за весь месяц и то как в витринах постепенно начинают появляться 
данные за разные дни Января)

https://disk.yandex.ru/i/w_0qcW1Mz8xqZg - видео к задаче 1.3. (Покажите, как вы разработали процедуру расчёта 
101-й формы и то как вы запускаете её расчёт и данные появляются в витрине)

https://disk.yandex.ru/i/-0Xe5eQc19SLuA - видео к задаче 1.4. (напишите скрипт, который позволит импортировать 
их обратно в БД. Поменяйте пару значений в выгруженном csv-файле и загрузите его в копию таблицы 
101-формы «dm. dm _f101_round_f_v2»)

